(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{197:function(t,e,n){t.exports=n.p+"static/media/drag-handle.5d691e22.svg"},198:function(t,e,n){t.exports=n.p+"static/media/root-tree.2a27d43a.svg"},200:function(t,e,n){t.exports=n.p+"static/media/logo.7d479a54.svg"},207:function(t,e,n){t.exports=n(588)},208:function(t,e,n){},344:function(t,e,n){},346:function(t,e,n){},348:function(t,e,n){},350:function(t,e,n){},352:function(t,e,n){},354:function(t,e,n){},356:function(t,e,n){},437:function(t,e,n){},439:function(t,e,n){},441:function(t,e,n){},443:function(t,e,n){},445:function(t,e,n){},447:function(t,e,n){},449:function(t,e,n){},451:function(t,e,n){},453:function(t,e,n){},455:function(t,e,n){},463:function(t,e,n){},465:function(t,e,n){},467:function(t,e,n){},469:function(t,e,n){},475:function(t,e,n){},478:function(t,e,n){},485:function(t,e){},528:function(t,e){},529:function(t,e){},588:function(t,e,n){"use strict";n.r(e);n(208),n(210);var a=n(0),i=n.n(a),s=n(113),r=n.n(s),o=n(2),c=n(3),u=n(5),l=n(4),p=n(6),d=n(11),h=n(205),b=n(8),m={en_gb:{_LANGUAGE:"British English",APPLY_TAG:"Apply tag",CLICK_TO_DISMISS:"Click to dismiss...",COLLAPSE_CHILDREN:"Collapse children",COLLAPSE_DETAILS:"Collapse task detail",DELETE_CHILDREN:"Delete Children",DELETE_MODAL:"You are trying to delete a task which has children. You can either move the children to the parent task, or delete all of the children as well.",DELETE_MODAL_SHORTCUT_HINT:"P.S. To skip this dialog in future, hold ctrl while pressing the delete button to move the children to the parent, or hold shift to delete the children.",DELETE_TASK:"Delete task",DONE_EDITING:"Done editing",EDIT_TASK:"Edit task",EDIT_TAGS:"Edit tags",EMAIL:"Email",EXPAND_CHILDREN:"Expand children",EXPAND_DETAILS:"Expand task detail",HELLO_USER:"Hello, {name}",LIME:"LiME",LOADING:"Loading...",LOG_IN_BUTTON:"Log in",LOG_IN_HEADER:"Log in...",MARK_COMPLETED:"Mark task completed",MARK_UNCOMPLETED:"Mark task uncompleted",MESSAGE_TOKEN_EXPIRED:"Your session has expired; please log in again",MOVE_CHILDREN:"Move Children",MOVE_TASK:"Click and drag here to move task",NAME:"Name",NEW_TASK:"New Task...",NO_TAGS_FOUND:"No matching tags found",NO_TASKS_YET:"No tasks here yet. Add one below...",NOTES:"Notes (supports Markdown)",PASSWORD:"Password",REGISTER_BUTTON:"Register",REGISTER_HEADER:"Register...",REMOVE_TAG:"Remove tag",ROOT_HERE:"Root task list here",SEARCH_TAGS:"Search tags...",SETTING_SAVED:"\u2713 Saved!",SETTINGS:"Settings"}};function f(t,e,n){var a=(m[t||"en_gb"]||{})[e];return void 0===a?e:function(t,e){for(var n in e)t=t.replace(new RegExp("\\{"+n+"\\}","gi"),e[n]);return t}(a,n)}function g(t,e,n,a){var i;a=a||n+"I18nArgs",("string"===typeof(i=e[n])||i instanceof String)&&(e[n]=f(t,e[n],e[a]||{})),delete e[a]}var O=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){var t=this.props,e=t.component,n=t.language,a=Object(h.a)(t,["component","language"]);return g(n,a,"children","contentI18nArgs"),g(n,a,"placeholder"),g(n,a,"title"),void 0!==a.childRef&&(a.ref=a.childRef,delete a.childRef),delete a.dispatch,i.a.createElement(e,a)}}]),e}(i.a.Component);O.defaultProps={component:"span"};var E=Object(b.b)(function(t){return{language:t.settings.language}})(O),v=n(203),k="__LOGOUT";function j(t,e,n){return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,i=arguments.length>1?arguments[1]:void 0;if(i.type===k)return e?t:a;var s=n[i.type];return s?s(a,i.payload):a}}function T(t,e){return e.reduce(function(e,n){return e[n]=t+n,e},{})}function _(){var t=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function A(t){return t.reduce(function(t,e){return t[e.object_id]=e,t},{})}function y(t){for(var e=Object.assign({},t),n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];for(var s=a.length-1;s>=0;s--)delete e[a[s]];return e}function S(t){return function(){this.setState(function(e){return Object(d.a)({},t,!e[t])})}}function D(t){return function(e){this.setState(Object(d.a)({},t,e.target.value))}}function C(t){var e={verticalAlign:"initial",width:"100%",height:"100%"},n=function(n){return i.a.createElement(E,Object.assign({component:"span"},n),i.a.createElement(t,{style:e}))};return n.displayName="withTitle("+t.displayName+")",n}function N(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),a=1;a<e;a++)n[a-1]=arguments[a];return function(){t.apply(void 0,n)}}function I(t){var e=function(e){var n=null;return void 0!==e.onClick&&(n=function(t){t.onclick=e.onClick}),i.a.createElement(v.a,Object.assign({src:t,callback:n,className:"reactSVG"},e))};return e.displayName="SVG("+t+")",e}function L(t){null!==t&&(t.onwheel=function(e){(e.deltaY<0&&0===t.scrollTop||e.deltaY>0&&t.scrollTop===t.scrollHeight-t.offsetHeight)&&(e.preventDefault(),e.stopPropagation())})}var M=T("MESSAGE_ACTION_",["ADD_MESSAGE","CLEAR_MESSAGE","LOGOUT"]),R={addMessageFromRequestError:function(t){var e=t.message;return null!==t.statusCode&&(e=t.statusCode+" - "+e),void 0!==t.response.error&&(e+=": "+t.response.error),R.addMessage("error",e)},addMessage:function(t,e){return{type:M.ADD_MESSAGE,payload:{level:t,message:e}}},clearMessage:function(t){return{type:M.CLEAR_MESSAGE,payload:{id:t}}}},G=n(23);function w(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),a=1;a<e;a++)n[a-1]=arguments[a];return function(e){t(R.addMessageFromRequestError(e)),401===e.statusCode&&t(P.logout()),n.map(function(e){return t(e)})}}var x=T("AUTH_ACTION_",["LOGIN_REQUEST","LOGIN_SUCCESS","REGISTER_REQUEST","REGISTER_SUCCESS","FAILURE"]),P={login:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/";return function(a,i){return a(P.loginRequest()),i().auth.backend.requestNoAuth("login",{email:t,password:e},function(t){a(P.loginSuccess(t)),a(Object(G.b)(n))},w(a,P.authFailure()))}},loginRequest:function(){return{type:x.LOGIN_REQUEST}},loginSuccess:function(t){return localStorage.setItem("token",JSON.stringify(t)),{type:x.LOGIN_SUCCESS,payload:{token:t}}},register:function(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/";return function(i,s){return i(P.registerRequest()),s().auth.backend.requestNoAuth("register",{email:t,password:e,name:n},function(t){i(P.registerSuccess(t)),i(Object(G.b)(a))},w(i,P.authFailure()))}},registerRequest:function(){return{type:x.REGISTER_REQUEST}},registerSuccess:function(t){return localStorage.setItem("token",JSON.stringify(t)),{type:x.REGISTER_SUCCESS,payload:{token:t}}},authFailure:function(){return{type:x.FAILURE}},logout:function(){return function(t,e){localStorage.clear("token"),t({type:k}),e().auth.backend.isAuthenticated()&&t({type:M.LOGOUT})}}},U=n(25),H=n(7),q=n(195),F=n(31),K=T("SETTING_ACTION_",["GOT_SETTINGS","SET_SETTING"]),B={getSettings:function(){return function(t,e){return e().auth.backend.request("get_settings",{},function(e){t(B.gotSettings(e))},w(t))}},gotSettings:function(t){return{type:K.GOT_SETTINGS,payload:{settings:t}}},setSetting:function(t,e,n){return function(a,i){return i().auth.backend.request("set_setting",{key:t,value:e},function(){a(B.setSetting_(t,e)),"function"===typeof n&&n()},w(a))}},setSetting_:function(t,e){return{type:K.SET_SETTING,payload:{key:t,value:e}}}},W=T("DB_OBJECT_ACTION_",["DELETE","FILTER","LOAD","MAP"]),V=function(t,e){return{type:W.DELETE,payload:{identifier:t,object_ids:e}}},Y=function(t,e){return{type:W.FILTER,payload:{identifier:t,func:e}}},X=function(t){return{type:W.LOAD,payload:{objects:t}}},J=function(t,e){return{type:W.MAP,payload:{identifier:t,func:e}}},Q={getTagsAndGroups:function(){return function(t,e){return e().auth.backend.request("get_tags_and_groups",{},function(e){t(X(e))},w(t))}},addTagGroup:function(t,e){return function(n,a){return a().auth.backend.request("add_tag_group",{title:t},function(t){n(X(t)),e()},w(n))}},addTag:function(t,e,n){return function(a,i){return i().auth.backend.request("add_tag",{title:t,group_id:e},function(t){a(X(t)),n()},w(a))}},applyTagToTasks:function(t,e,n){return function(a,i){return i().auth.backend.request("apply_tag_to_tasks",{tag_id:t,task_ids:e},function(t){a(X(t)),n()},w(a))}},removeTagFromTasks:function(t,e){return function(n,a){return a().auth.backend.request("remove_tag_from_tasks",{tag_id:t,task_ids:e},function(t){n(X(t))},w(n))}},deleteTagGroup:function(t){return function(e,n){return n().auth.backend.request("delete_tag_group",{group_id:t.object_id},function(){e(V("TagGroup",[t.object_id])),e(Y("Tag",function(e){return e.group_id!==t.object_id}));var n=new Set(t.tag_ids);e(J("Task",function(t){var e=t.tag_ids.filter(function(t){return!n.has(t)});return e.length===t.tag_ids.length?t:Object.assign({},t,{tag_ids:e})}))},w(e))}},deleteTag:function(t){return function(e,n){return n().auth.backend.request("delete_tag",{tag_id:t},function(){e(V("Tag",[t])),e(J("Task",function(e){return e.tag_ids.includes(t)?Object.assign({},e,{tag_ids:e.tag_ids.filter(function(e){return e!==t})}):e}))},w(e))}}},z=n(196),Z=n.n(z),$=(n(344),n(14)),tt=T("CHILDREN_LOADED_ACTION_",["LOADED","DELETE"]),et=function(t){return{type:tt.LOADED,payload:{parent_id:t}}},nt=function(t){return{type:tt.DELETE,payload:{parent_ids:t}}};var at={getTasks:function(t){return function(e,n){return n().auth.backend.request("get_tasks",{parent_id:t},function(n){e(X(n)),e(et(t))},w(e))}},getTask:function(t){return function(e,n){return n().auth.backend.request("get_task",{task_id:t},function(t){e(X(t))},w(e))}},addTask:function(t,e,n){return function(a,i){return i().auth.backend.request("add_task",{parent_id:t,title:e},function(t){a(X(t)),n()},w(a))}},deleteTask:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,a){return a().auth.backend.request("delete_task",{task_id:t.object_id,cascade:e},function(i){var s=function(t,e,n){var a=new Set([e]);if(!n)return a;function i(t){return function(e){return t.has(e.parent_id)||t.has(e.object_id)}}for(var s=function(t){return t.object_id},r=new Set(Object.values(t).filter(i(a)).map(s));r.size>a.size;)a=r,r=new Set(Object.values(t).filter(i(a)).map(s));return r}(a().tasks,t.object_id,e);n(V("Task",s)),n(nt(s)),n(X(i))},w(n))}},updateTask:function(t,e,n){return function(a,i){return i().auth.backend.request("update_task",Object.assign({task_id:t},e),function(t){a(X(t)),"function"===typeof n&&n()},w(a))}},reorderTask:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(a,i){return i().auth.backend.request("reorder_task",{task_id:t,after_id:e,before_id:n},function(t){a(X(t))},w(a))}},reparentTask:function(t,e){return function(n,a){return a().auth.backend.request("reparent_task",{task_id:t,parent_id:e},function(t){n(X(t))},w(n))}}},it=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){void 0===this.props.task&&this.props.actions.getTask(this.props.taskID)}},{key:"componentDidUpdate",value:function(t){t.taskID!==this.props.taskID&&void 0===this.props.task&&this.props.actions.getTask(this.props.taskID)}},{key:"render",value:function(){return void 0===this.props.task?null:i.a.createElement("div",{className:"TaskHeader"},i.a.createElement(U.a,{to:null===this.props.task.parent_id?"/":"/parent/"+this.props.task.parent_id},i.a.createElement($.k,{className:"goUp"})),i.a.createElement("h2",null,this.props.task.title))}}]),e}(i.a.Component);var st=Object(b.b)(function(t,e){return{task:t.tasks[e.taskID]}},function(t){return{actions:Object(H.bindActionCreators)(at,t)}})(it),rt=(n(346),n(348),function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(u.a)(this,Object(l.a)(e).call(this,t))).state={title:""},n}return Object(p.a)(e,t),Object(c.a)(e,[{key:"clearForm",value:function(){this.setState({title:""})}},{key:"maybeSubmit",value:function(t){t&&"Enter"===t.key&&(t.preventDefault(),this.props.actions.addTask(this.props.parentID,this.state.title,this.clearForm.bind(this)))}},{key:"focusInput",value:function(){this.taskInput.focus()}},{key:"render",value:function(){var t=this;return this.props.connectDropTarget(i.a.createElement("div",{className:this.props.isOver?"NewTaskForm isOver":"NewTaskForm"},i.a.createElement($.a,{className:"addTaskIcon",onClick:this.focusInput.bind(this)}),i.a.createElement("form",null,i.a.createElement(E,{component:"input",type:"text",placeholder:"NEW_TASK",value:this.state.title,childRef:function(e){t.taskInput=e},onChange:D("title").bind(this),onKeyPress:this.maybeSubmit.bind(this)}))))}}]),e}(i.a.Component));var ot=Object(b.b)(null,function(t){return{actions:Object(H.bindActionCreators)(at,t)}})(Object(F.DropTarget)("TASK",{canDrop:function(t,e){return e.getItem().task_id!==t.lastTaskID},drop:function(t,e){e.didDrop()||(null===t.lastTaskID?t.actions.reparentTask(e.getItem().task_id,t.parentID):t.actions.reorderTask(e.getItem().task_id,null,t.lastTaskID))}},function(t,e){return{connectDropTarget:t.dropTarget(),isOver:e.isOver({shallow:!0})&&e.canDrop()}})(rt)),ct=(n(350),{savedTimeout:2500,messageTimeout:5e3,dragExpandChildrenTimeout:1e3}),ut=ct=Object.assign({},ct,{apiHost:"https://limeapi.fivebit.co.uk/"}),lt=(n(352),n(354),function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(u.a)(this,Object(l.a)(e).call(this,t))).state={saved:!1,value:t.value,savedTimeout:null},n}return Object(p.a)(e,t),Object(c.a)(e,[{key:"handleChange",value:function(){return function(t){this.setState({saved:!1,value:t.target.value})}}},{key:"componentWillUnmount",value:function(){this.saveChanges(),null!==this.state.savedTimeout&&clearTimeout(this.state.savedTimeout)}},{key:"markSaved",value:function(){var t=this;null!==this.state.savedTimeout&&clearTimeout(this.state.savedTimeout),this.setState({saved:!0,savedTimeout:setTimeout(function(){return t.setState({saved:!1})},ut.savedTimeout)})}},{key:"saveChanges",value:function(){this.state.value!==this.props.value&&this.props.saveValue(this.state.value,this.markSaved.bind(this))}}]),e}(i.a.Component)),pt=n(1),dt=n.n(pt),ht=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{className:this.state.saved?"EditTaskNotes saved":"EditTaskNotes"},i.a.createElement(E,{component:"textarea",childRef:L,value:this.state.value,onChange:this.handleChange().bind(this),onBlur:this.saveChanges.bind(this),placeholder:"NOTES"}))}}]),e}(lt);ht.propTypes={task_id:dt.a.number.isRequired};var bt=Object(b.b)(null,function(t,e){var n=Object(H.bindActionCreators)(at.updateTask,t);return{saveValue:function(t,a){n(e.task_id,{notes:t},a)}}})(ht),mt=(n(356),n(75)),ft=n.n(mt),gt=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{className:"TaskNotes",ref:L},i.a.createElement(ft.a,{source:this.props.task.notes,skipHtml:!0}))}}]),e}(i.a.Component),Ot=(n(437),n(439),function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"removeTag",value:function(){this.props.actions.removeTagFromTasks(this.props.tag.object_id,[this.props.task_id])}},{key:"render",value:function(){var t=C($.e);return i.a.createElement("li",{className:"TaskTag"},this.props.tag.title,this.props.editMode?i.a.createElement(t,{className:"removeTag",onClick:this.removeTag.bind(this),title:"REMOVE_TAG"}):null)}}]),e}(i.a.Component));var Et=Object(b.b)(null,function(t){return{actions:Object(H.bindActionCreators)(Q,t)}})(Ot),vt=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){var t=this,e=this.props.task.object_id,n=this.props.tags.map(function(n){return void 0!==n?i.a.createElement(Et,{tag:n,task_id:e,key:e+"-"+n.object_id,editMode:t.props.editMode}):null});return i.a.createElement("ul",{className:"TaskTagList",ref:L},n)}}]),e}(i.a.Component);var kt=Object(b.b)(function(t,e){return{tags:e.task.tag_ids.map(function(e){return t.tags[e]})}},null)(vt),jt=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{className:"TaskDetails"},i.a.createElement("div",{className:"notesWrapper"},this.props.editMode?i.a.createElement(bt,{task_id:this.props.task.object_id,value:this.props.task.notes}):i.a.createElement(gt,{task:this.props.task})),i.a.createElement(kt,{task:this.props.task,editMode:this.props.editMode}),i.a.createElement("div",{className:"clearfix"}))}}]),e}(i.a.Component),Tt=(n(441),T("MODAL_ACTION_",["SHOW_MODAL","CLOSE_TOP","CLOSE_ALL"])),_t={showModal:function(t,e){return{type:Tt.SHOW_MODAL,payload:{modal:t,props:e}}},closeTopModal:function(){return{type:Tt.CLOSE_TOP}},closeAllModals:function(){return{type:Tt.CLOSE_ALL}}},At=(n(443),n(445),function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"dontClose",value:function(t){t.stopPropagation()}},{key:"closeTop",value:function(){this.props.actions.closeTopModal()}},{key:"closeAll",value:function(){this.props.actions.closeAllModals()}},{key:"render",value:function(){return i.a.createElement("div",{className:void 0!==this.props.className?"Modal "+this.props.className:"Modal",onClick:this.dontClose},this.props.hasPrevious?i.a.createElement($.b,{className:"previousModal",onClick:this.closeTop.bind(this)}):null,i.a.createElement($.e,{className:"closeModal",onClick:this.closeAll.bind(this)}),this.props.children)}}]),e}(i.a.Component));var yt=Object(b.b)(function(t){return{hasPrevious:t.modals.length>1}},function(t){return{actions:Object(H.bindActionCreators)(_t,t)}})(At),St=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"deleteChildren",value:function(){this.props.taskActions.deleteTask(this.props.task,!0),this.props.modalActions.closeTopModal()}},{key:"reparentChildren",value:function(){this.props.taskActions.deleteTask(this.props.task,!1),this.props.modalActions.closeTopModal()}},{key:"render",value:function(){return i.a.createElement(yt,{className:"DeleteTaskModal"},i.a.createElement(E,{component:"p"},"DELETE_MODAL"),i.a.createElement(E,{component:"button",className:"reparentChildren",onClick:this.reparentChildren.bind(this)},"MOVE_CHILDREN"),i.a.createElement(E,{component:"button",className:"deleteChildren",onClick:this.deleteChildren.bind(this)},"DELETE_CHILDREN"),i.a.createElement(E,{component:"p",className:"small"},"DELETE_MODAL_SHORTCUT_HINT"))}}]),e}(i.a.Component);var Dt=Object(b.b)(null,function(t){return{taskActions:Object(H.bindActionCreators)(at,t),modalActions:Object(H.bindActionCreators)(_t,t)}})(St),Ct=(n(447),function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement(yt,{className:"EditTagsModal"},i.a.createElement(E,{component:"h3"},"EDIT_TAGS"))}}]),e}(i.a.Component));var Nt=Object(b.b)(null,function(t){return{tagActions:Object(H.bindActionCreators)(Q,t),modalActions:Object(H.bindActionCreators)(_t,t)}})(Ct),It=n(204),Lt=(n(449),function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{className:"SettingWrapper "+this.props.settingType},i.a.createElement("label",{htmlFor:this.props.setting},this.props.label,this.props.saved?i.a.createElement(E,{className:"saved"},"SETTING_SAVED"):null),this.props.children)}}]),e}(i.a.Component));function Mt(t,e){return{value:t.settings[e.setting]}}function Rt(t,e){var n=Object(H.bindActionCreators)(B.setSetting,t);return{saveValue:function(t,a){n(e.setting,t,a)}}}function Gt(t){return Object(b.b)(Mt,Rt)(t)}var wt=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement(Lt,{settingType:"DropdownSetting",setting:this.props.setting,label:this.props.label,saved:this.state.saved},i.a.createElement("select",{id:this.props.setting,type:this.fieldType,onChange:this.handleChange().bind(this),onBlur:this.saveChanges.bind(this),value:this.state.value},this.props.options.map(function(t){return i.a.createElement("option",{key:t.value,value:t.value},t.label)})))}}]),e}(lt);wt.propTypes={label:dt.a.string.isRequired,options:dt.a.array.isRequired,setting:dt.a.string.isRequired};var xt=Gt(wt),Pt=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(u.a)(this,Object(l.a)(e).call(this,t))).fieldType=t.fieldType||"text",n}return Object(p.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement(Lt,{settingType:"TextSetting",setting:this.props.setting,label:this.props.label,saved:this.state.saved},i.a.createElement("input",{id:this.props.setting,type:this.fieldType,value:this.state.value,onChange:this.handleChange().bind(this),onBlur:this.saveChanges.bind(this)}))}}]),e}(lt);Pt.propTypes={fieldType:dt.a.string,label:dt.a.string.isRequired,setting:dt.a.string.isRequired};var Ut,Ht=Gt(Pt),qt=T("SETTING_TYPE_",["DROPDOWN","EMAIL","TEXT"]);var Ft=(Ut={},Object(d.a)(Ut,qt.DROPDOWN,xt),Object(d.a)(Ut,qt.EMAIL,function(t){return i.a.createElement(Ht,Object.assign({},t,{fieldType:"email"}))}),Object(d.a)(Ut,qt.TEXT,Ht),Ut),Kt=[{setting:"name",label:"Your name",type:qt.TEXT},{setting:"email",label:"Your email",type:qt.EMAIL},{setting:"deletion_behaviour",label:"Behaviour when deleting tasks with children",type:qt.DROPDOWN,options:[{value:"ASK",label:"Ask every time"},{value:"CASCADE",label:"Delete children recursively"},{value:"REPARENT",label:"Move children to parent task"}]},{setting:"language",label:"Language",type:qt.DROPDOWN,options:Object.entries(m).map(function(t){var e=Object(It.a)(t,2);return{value:e[0],label:e[1]._LANGUAGE}})}];function Bt(t){return i.a.createElement(Ft[t.type],Object.assign({},t,{key:t.setting}))}var Wt=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"edit_tags",value:function(t){t.preventDefault(),this.props.modalActions.showModal(Xt.EDIT_TAGS,{})}},{key:"render",value:function(){return i.a.createElement(yt,{className:"SettingsModal"},i.a.createElement(E,{component:"h3"},"SETTINGS"),Kt.map(Bt),i.a.createElement(E,{component:"button",className:"editTags",onClick:this.edit_tags.bind(this)},"EDIT_TAGS"))}}]),e}(i.a.Component);var Vt,Yt=Object(b.b)(null,function(t){return{modalActions:Object(H.bindActionCreators)(_t,t)}})(Wt),Xt=T("MODAL_",["DELETE_TASK","EDIT_TAGS","SETTINGS"]),Jt=(Vt={},Object(d.a)(Vt,Xt.DELETE_TASK,Dt),Object(d.a)(Vt,Xt.EDIT_TAGS,Nt),Object(d.a)(Vt,Xt.SETTINGS,Yt),Vt);n(451);var Qt=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{className:this.state.saved?"EditTaskTitle saved":"EditTaskTitle"},i.a.createElement("input",{type:"text",value:this.state.value,onChange:this.handleChange().bind(this),onBlur:this.saveChanges.bind(this),autoFocus:!0}))}}]),e}(lt);Qt.propTypes={task_id:dt.a.number.isRequired};var zt=Object(b.b)(null,function(t,e){var n=Object(H.bindActionCreators)(at.updateTask,t);return{saveValue:function(t,a){n(e.task_id,{title:t},a)}}})(Qt),Zt=n(197),$t=n.n(Zt),te=n(198),ee=n.n(te),ne=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"deleteTask",value:function(t){!this.props.task.has_children||t.ctrlKey||"REPARENT"===this.props.deletionBehaviour?this.props.taskActions.deleteTask(this.props.task,!1):t.shiftKey||"CASCADE"===this.props.deletionBehaviour?this.props.taskActions.deleteTask(this.props.task,!0):this.props.modalActions.showModal(Xt.DELETE_TASK,{task:this.props.task})}},{key:"markAsCompleted",value:function(){this.props.taskActions.updateTask(this.props.task.object_id,{completed:!0})}},{key:"markAsUncompleted",value:function(){this.props.taskActions.updateTask(this.props.task.object_id,{completed:!1})}},{key:"render",value:function(){var t=["TaskMainInfo"];this.props.task.completed&&t.push("completed");var e=C($.m),n=C($.i),a=C($.e),s=C($.f),r=C(I($t.a)),o=C($.g),c=C($.n),u=C($.j),l=C(I(ee.a)),p=C($.c),d=C($.d),h=this.props.connectDragSource(i.a.createElement("div",null,i.a.createElement(r,{className:"dragHandle",title:"MOVE_TASK"})));return this.props.connectDragPreview(i.a.createElement("div",{className:t.join(" ")},h,this.props.task.completed?i.a.createElement(p,{onClick:this.markAsUncompleted.bind(this),className:"taskCompleted",title:"MARK_UNCOMPLETED"}):i.a.createElement(d,{onClick:this.markAsCompleted.bind(this),className:"taskCompleted",title:"MARK_COMPLETED"}),this.props.editMode?i.a.createElement(zt,{task_id:this.props.task.object_id,value:this.props.task.title}):i.a.createElement(ft.a,{className:"title",allowedTypes:["root","emphasis","strong","delete","link","inlineCode"],source:this.props.task.title,skipHtml:!0,unwrapDisallowed:!0,linkTarget:"_blank"}),this.props.editMode||this.props.detailsShown?null:i.a.createElement(kt,{task:this.props.task,editMode:!1}),this.props.detailsShown?i.a.createElement(n,{className:"toggleDetails",onClick:this.props.toggleDetails,title:"COLLAPSE_DETAILS"}):i.a.createElement(u,{className:"toggleDetails",onClick:this.props.toggleDetails,title:"EXPAND_DETAILS"}),this.props.editMode?i.a.createElement(s,{className:"toggleEditMode",onClick:this.props.toggleEditMode,title:"DONE_EDITING"}):i.a.createElement(o,{className:"toggleEditMode",onClick:this.props.toggleEditMode,title:"EDIT_TASK"}),i.a.createElement(e,{className:"applyTag",onClick:this.props.toggleTagMenu,title:"APPLY_TAG"}),i.a.createElement(l,{className:"rootTree",onClick:N(this.props.goTo,"/parent/"+this.props.task.object_id),title:"ROOT_HERE"}),i.a.createElement(c,{className:this.props.task.has_children?"expandChildren hasChildren":"expandChildren",onClick:this.props.toggleExpandChildren,title:this.props.childrenExpanded?"COLLAPSE_CHILDREN":"EXPAND_CHILDREN"}),i.a.createElement(a,{className:"deleteTask",onClick:this.deleteTask.bind(this),title:"DELETE_TASK"})))}}]),e}(i.a.Component);var ae=Object(b.b)(function(t){return{deletionBehaviour:t.settings.deletion_behaviour}},function(t){return{taskActions:Object(H.bindActionCreators)(at,t),modalActions:Object(H.bindActionCreators)(_t,t),goTo:Object(H.bindActionCreators)(G.b,t)}})(ne),ie=(n(453),n(455),function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"applyTag",value:function(t){return function(){this.props.actions.applyTagToTasks(t,[this.props.task.object_id],this.props.hideMenu)}}},{key:"render",value:function(){var t=function(t){var e=["tag"];return null!==t.group_id&&e.push("inGroup"),i.a.createElement("li",{className:e.join(" "),key:"tag-"+t.object_id,onClick:this.applyTag(t.object_id).bind(this)},t.title)}.bind(this),e=this.props.tags.map(t).concat(this.props.groups.map(function(e){var n=e.group,a=e.tags;return[i.a.createElement("li",{className:"group",key:"group-"+n.object_id},n.title)].concat(a.map(t))}));return i.a.createElement("ul",{className:"TagMenuTagList"},e.length>0?e:i.a.createElement(E,{component:"li",className:"notFound",key:"notFound"},"NO_TAGS_FOUND"))}}]),e}(i.a.Component));var se=Object(b.b)(function(t,e){var n=function(t){return t.toLowerCase().includes(e.searchText.toLowerCase())};return{groups:Object.values(t.tag_groups).filter(function(t){return n(t.title)}).map(function(n){for(var a=[],i=Object.values(t.tags).find(function(t){return t.group_id===n.object_id&&null===t.before_id});void 0!==i;)e.task.tag_ids.includes(i.object_id)||a.push(i),i=t.tags[i.after_id];return{group:n,tags:a}}),tags:Object.values(t.tags).filter(function(t){return n(t.title)&&!e.task.tag_ids.includes(t.object_id)&&(""!==e.searchText||null===t.group_id)})}},function(t){return{actions:Object(H.bindActionCreators)(Q,t)}})(ie),re=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(u.a)(this,Object(l.a)(e).call(this,t))).state={searchText:""},n}return Object(p.a)(e,t),Object(c.a)(e,[{key:"clearForm",value:function(){this.setState({searchText:""})}},{key:"componentDidMount",value:function(){this.searchInput.focus()}},{key:"render",value:function(){var t=this;return i.a.createElement("div",{className:"TaskTagMenu"},i.a.createElement("div",{className:"rightShift"},i.a.createElement(E,{component:"input",type:"text",placeholder:"SEARCH_TAGS",value:this.state.searchText,childRef:function(e){t.searchInput=e},onChange:D("searchText").bind(this)}),i.a.createElement(se,{task:this.props.task,searchText:this.state.searchText,hideMenu:this.props.hideMenu})))}}]),e}(i.a.Component),oe=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(u.a)(this,Object(l.a)(e).call(this,t))).state={expandChildren:!1,expandChildrenForDragging:!1,dragTimeout:null,editMode:!1,showDetails:!1},n}return Object(p.a)(e,t),Object(c.a)(e,[{key:"componentDidUpdate",value:function(t){t.isOver!==this.props.isOver&&(null!==this.state.dragTimeout&&clearTimeout(this.state.dragTimeout),this.setState({dragTimeout:setTimeout(function(){this.setState({expandChildrenForDragging:this.props.isOver,dragTimeout:null})}.bind(this),ut.dragExpandChildrenTimeout)}))}},{key:"render",value:function(){var t=["Task"];this.props.isOverSelfOnly&&this.props.canDrop&&t.push("dropHere"),this.props.isDragging&&t.push("isDragging"),this.state.expandChildren&&t.push("expandChildren"),this.state.editMode&&t.push("editMode");var e,n,a={childrenExpanded:this.state.expandChildren,editMode:this.state.editMode,detailsShown:this.state.showDetails,showTagMenu:this.state.showTagMenu,task:this.props.task,toggleExpandChildren:S("expandChildren").bind(this),toggleEditMode:S("editMode").bind(this),toggleDetails:S("showDetails").bind(this),toggleTagMenu:S("showTagMenu").bind(this),connectDragSource:this.props.connectDragSource,connectDragPreview:this.props.connectDragPreview},s={editMode:this.state.editMode,task:this.props.task};return this.props.connectDropTarget(i.a.createElement("div",{className:t.join(" ")},i.a.createElement("div",{className:"taskInfo"},i.a.createElement(ae,a),!this.state.showDetails&&!this.state.editMode||this.props.isDragging?null:i.a.createElement(jt,s)),this.state.showTagMenu?i.a.createElement(re,{task:this.props.task,hideMenu:(e="showTagMenu",n=!1,function(){this.setState(Object(d.a)({},e,n))}).bind(this)}):null,!this.state.expandChildren&&!this.state.expandChildrenForDragging||this.props.isDragging?null:i.a.createElement(le,{parentID:this.props.task.object_id,alternateDepth:this.props.alternateDepth})))}}]),e}(i.a.Component);var ce=Object(b.b)(null,function(t){return{actions:Object(H.bindActionCreators)(at,t)}})(Object(F.DragSource)("TASK",{beginDrag:function(t){return{task_id:t.task.object_id}}},function(t,e){return{connectDragSource:t.dragSource(),connectDragPreview:t.dragPreview(),isDragging:e.isDragging()}})(Object(F.DropTarget)("TASK",{canDrop:function(t,e){var n=e.getItem().task_id;return n!==t.task.object_id&&n!==t.task.before_id},drop:function(t,e){e.didDrop()||t.actions.reorderTask(e.getItem().task_id,t.task.object_id)}},function(t,e){return{connectDropTarget:t.dropTarget(),isOver:e.isOver(),isOverSelfOnly:e.isOver({shallow:!0}),canDrop:e.canDrop()}})(oe))),ue=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){this.props.childrenLoaded||this.props.actions.getTasks(this.props.parentID)}},{key:"componentDidUpdate",value:function(t){t.parentID===this.props.parentID||this.props.childrenLoaded||this.props.actions.getTasks(this.props.parentID)}},{key:"render",value:function(){var t,e=this;t=this.props.childrenLoaded?this.props.tasks.length>0?this.props.tasks.map(function(t){return i.a.createElement(ce,{task:t,key:t.object_id,alternateDepth:!e.props.alternateDepth})}):i.a.createElement(E,{component:"div",className:"noTasks"},"NO_TASKS_YET"):i.a.createElement(E,{component:"div",className:"tasksLoading"},"LOADING");var n=this.props.tasks.length>0?this.props.tasks[this.props.tasks.length-1].object_id:null;return i.a.createElement("div",{className:this.props.alternateDepth?"TaskList alternateDepth":"TaskList"},i.a.createElement("div",{className:"tasks"},t),i.a.createElement(ot,{parentID:this.props.parentID,lastTaskID:n}))}}]),e}(i.a.Component);var le=Object(b.b)(function(t,e){for(var n=[],a=Object.values(t.tasks).find(function(t){return t.parent_id===e.parentID&&null===t.before_id});void 0!==a;)n.push(a),a=t.tasks[a.after_id];return{tasks:n,childrenLoaded:void 0!==t.childrenLoaded[e.parentID]}},function(t){return{actions:Object(H.bindActionCreators)(at,t)}})(ue),pe=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"parentID",value:function(){return parseInt(this.props.match.params.parentID,10)||null}},{key:"componentDidMount",value:function(){this.props.settingActions.getSettings(),this.props.tagActions.getTagsAndGroups()}},{key:"render",value:function(){return i.a.createElement("div",{className:"App"},null!==this.parentID()?i.a.createElement(st,{taskID:this.parentID()}):null,i.a.createElement(le,{parentID:this.parentID(),alternateDepth:!0}))}}]),e}(i.a.Component);var de=Object(b.b)(null,function(t){return{settingActions:Object(H.bindActionCreators)(B,t),tagActions:Object(H.bindActionCreators)(Q,t)}})(Object(F.DragDropContext)(Z.a)(pe)),he=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(u.a)(this,Object(l.a)(e).call(this,t))).state={email:"",password:""},n}return Object(p.a)(e,t),Object(c.a)(e,[{key:"login",value:function(t){t.preventDefault(),this.props.actions.login(this.state.email,this.state.password,this.props.next)}},{key:"render",value:function(){return i.a.createElement("div",{className:"LoginForm"},i.a.createElement(E,{component:"h3"},"LOG_IN_HEADER"),i.a.createElement("form",null,i.a.createElement(E,{component:"input",type:"email",placeholder:"EMAIL",value:this.state.email,onChange:D("email").bind(this)}),i.a.createElement(E,{component:"input",type:"password",placeholder:"PASSWORD",value:this.state.password,onChange:D("password").bind(this)}),i.a.createElement(E,{component:"button",type:"submit",disabled:this.props.isAuthenticating,onClick:this.login.bind(this)},"LOG_IN_BUTTON")))}}]),e}(i.a.Component);var be=Object(b.b)(function(t){return{isAuthenticating:t.auth.isAuthenticating}},function(t){return{actions:Object(H.bindActionCreators)(P,t)}})(he),me=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(u.a)(this,Object(l.a)(e).call(this,t))).state={email:"",password:"",name:""},n}return Object(p.a)(e,t),Object(c.a)(e,[{key:"register",value:function(t){t.preventDefault(),this.props.actions.register(this.state.email,this.state.password,this.state.name,this.props.next)}},{key:"render",value:function(){return i.a.createElement("div",{className:"RegisterForm"},i.a.createElement(E,{component:"h3"},"REGISTER_HEADER"),i.a.createElement("form",null,i.a.createElement(E,{component:"input",type:"email",placeholder:"EMAIL",value:this.state.email,onChange:D("email").bind(this)}),i.a.createElement(E,{component:"input",type:"password",placeholder:"PASSWORD",value:this.state.password,onChange:D("password").bind(this)}),i.a.createElement(E,{component:"input",type:"text",placeholder:"NAME",value:this.state.name,onChange:D("name").bind(this)}),i.a.createElement(E,{component:"button",type:"submit",disabled:this.props.isAuthenticating,onClick:this.register.bind(this)},"REGISTER_BUTTON")))}}]),e}(i.a.Component);var fe=Object(b.b)(function(t){return{isAuthenticating:t.auth.isAuthenticating}},function(t){return{actions:Object(H.bindActionCreators)(P,t)}})(me),ge=n(199),Oe=n.n(ge),Ee=function(t){function e(t){var n;return Object(o.a)(this,e),(n=Object(u.a)(this,Object(l.a)(e).call(this,t))).next=Oe.a.parse(n.props.location.search).next||"/",n}return Object(p.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{className:"HomePage"},i.a.createElement(be,{next:this.next}),i.a.createElement(fe,{next:this.next}))}}]),e}(i.a.Component),ve=(n(463),n(465),n(467),function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"logout",value:function(t){t.preventDefault(),this.props.authActions.logout()}},{key:"settings",value:function(t){t.preventDefault(),this.props.modalActions.showModal(Xt.SETTINGS,{})}},{key:"render",value:function(){return this.props.isAuthenticated?i.a.createElement("div",{className:"UserHeader"},i.a.createElement("button",{className:"logoutButton",onClick:this.logout.bind(this)},"Log out"),i.a.createElement("div",{className:"settings",onClick:this.settings.bind(this)},i.a.createElement($.o,null)),this.props.name?i.a.createElement(E,{component:"p",contentI18nArgs:{name:this.props.name}},"HELLO_USER"):null):null}}]),e}(i.a.Component));var ke=Object(b.b)(function(t){return{isAuthenticated:t.auth.backend.isAuthenticated(),name:t.settings.name}},function(t){return{authActions:Object(H.bindActionCreators)(P,t),modalActions:Object(H.bindActionCreators)(_t,t)}})(ve),je=n(200),Te=n.n(je),_e=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("header",{className:"Header"},i.a.createElement(U.a,{to:"/"},i.a.createElement("img",{src:Te.a,className:"Header-logo",alt:"logo"})),i.a.createElement("h2",null,i.a.createElement(E,{component:U.a,to:"/"},"LIME")),i.a.createElement(ke,null))}}]),e}(i.a.Component),Ae=(n(469),n(76)),ye=n.n(Ae),Se=(n(475),{error:i.a.createElement($.h,{className:"messageIcon"}),warning:i.a.createElement($.p,{className:"messageIcon"}),info:i.a.createElement($.l,{className:"messageIcon"}),success:i.a.createElement($.f,{className:"messageIcon"})}),De=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){var t=this;setTimeout(function(){return t.props.actions.clearMessage(t.props.id)},ut.messageTimeout)}},{key:"disappear",value:function(t){t.preventDefault(),this.props.actions.clearMessage(this.props.id)}},{key:"render",value:function(){return i.a.createElement(E,{component:"div",className:"Message "+this.props.level,onClick:this.disappear.bind(this),title:"CLICK_TO_DISMISS"},Se[this.props.level],i.a.createElement(E,null,this.props.message))}}]),e}(i.a.Component);var Ce=Object(b.b)(null,function(t){return{actions:Object(H.bindActionCreators)(R,t)}})(De),Ne=n(77),Ie=n.n(Ne),Le=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{className:"Messages"},i.a.createElement(Ie.a,null,this.props.messages.map(function(t){return i.a.createElement(ye.a,{key:t.id,classNames:"message",timeout:250},i.a.createElement(Ce,t))})))}}]),e}(i.a.Component);var Me=Object(b.b)(function(t){return{messages:t.messages}})(Le),Re=(n(478),function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{className:"ModalContainer"},i.a.createElement(Ie.a,null,null!==this.props.modal?i.a.createElement(ye.a,{classNames:"modal",timeout:250,in:null!==this.props.modal},i.a.createElement("div",{className:"modalOverlay",onClick:this.props.actions.closeAllModals},this.props.modal)):null))}}]),e}(i.a.Component));var Ge=Object(b.b)(function(t){return{modal:t.modals.length>0?t.modals.slice(-1)[0]:null}},function(t){return{actions:Object(H.bindActionCreators)(_t,t)}})(Re),we=function(t){function e(){return Object(o.a)(this,e),Object(u.a)(this,Object(l.a)(e).apply(this,arguments))}return Object(p.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement("div",{className:this.props.modalOpen?"Layout modalOpen":"Layout"},i.a.createElement(Ge,null),i.a.createElement("div",{className:"content"},i.a.createElement(_e,null),i.a.createElement(Me,null),i.a.createElement("div",{className:"container"},this.props.children)))}}]),e}(i.a.Component);var xe,Pe,Ue,He=Object(U.c)(Object(b.b)(function(t){return{modalOpen:t.modals.length>0}})(we)),qe=n(74),Fe=n.n(qe),Ke=n(201),Be=n.n(Ke),We=function(){function t(e){Object(o.a)(this,t),this.token=e}return Object(c.a)(t,[{key:"isAuthenticated",value:function(){return null!==this.token}},{key:"request",value:function(t,e,n,a){if(!this.isAuthenticated()){var i=new Error("Unauthorized");return i.statusCode=401,i.response={},void a(i)}return e=Object.assign({},e,{token:this.token}),this.requestNoAuth(t,e,n,a)}},{key:"requestNoAuth",value:function(t,e,n,a){return fetch(ut.apiHost+t,{method:"post",mode:"cors",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(t){if(t.status>=200&&t.status<300)return t.json();var e=new Error("Failed request");throw e.response=t,e}).then(n,function(t){if(t instanceof TypeError){var e=new Error("Network failure");e.statusCode=null,e.response={error:"Could not connect to backend: "+t.message},a(e)}else t.response.json().then(function(e){var n=new Error(t.response.statusText);n.statusCode=t.response.status,n.response=e,a(n)})})}}]),t}(),Ve=j({backend:new We(null),isAuthenticating:!1},!0,(xe={},Object(d.a)(xe,x.LOGIN_REQUEST,function(t){return Object.assign({},t,{isAuthenticating:!0})}),Object(d.a)(xe,x.LOGIN_SUCCESS,function(t,e){return Object.assign({},t,{isAuthenticating:!1,backend:new We(e.token)})}),Object(d.a)(xe,x.REGISTER_REQUEST,function(t){return Object.assign({},t,{isAuthenticating:!0})}),Object(d.a)(xe,x.REGISTER_SUCCESS,function(t,e){return Object.assign({},t,{isAuthenticating:!1,backend:new We(e.token)})}),Object(d.a)(xe,x.FAILURE,function(t){return Object.assign({},t,{isAuthenticating:!1})}),xe)),Ye=n(78),Xe=j({},!0,(Pe={},Object(d.a)(Pe,tt.LOADED,function(t,e){return Object.assign({},t,Object(d.a)({},e.parent_id,!0))}),Object(d.a)(Pe,tt.DELETE,function(t,e){return y.apply(void 0,[t].concat(Object(Ye.a)(e.parent_ids)))}),Pe)),Je={};function Qe(t){var e;return j(Je,!0,(e={},Object(d.a)(e,W.DELETE,function(e,n){return n.identifier!==t?e:y.apply(void 0,[e].concat(Object(Ye.a)(n.object_ids)))}),Object(d.a)(e,W.FILTER,function(e,n){return n.identifier!==t?e:Object.assign({},A(Object.values(e).filter(n.func)))}),Object(d.a)(e,W.LOAD,function(e,n){var a=n.objects.filter(function(e){return e.__identifier===t});return 0===a.length?e:Object.assign({},e,A(a))}),Object(d.a)(e,W.MAP,function(e,n){return n.identifier!==t?e:Object.assign({},A(Object.values(e).map(n.func)))}),e))}var ze,Ze,$e=[],tn=j($e,!1,(Ue={},Object(d.a)(Ue,M.ADD_MESSAGE,function(t,e){return t.concat([{id:_(),level:e.level,message:e.message}])}),Object(d.a)(Ue,M.CLEAR_MESSAGE,function(t,e){return t.filter(function(t){return t.id!==e.id})}),Object(d.a)(Ue,M.LOGOUT,function(){return $e}),Ue)),en=[],nn=j(en,!0,(ze={},Object(d.a)(ze,Tt.SHOW_MODAL,function(t,e){return t.concat([(n=e.modal,a=e.props,i.a.createElement(Jt[n],a))]);var n,a}),Object(d.a)(ze,Tt.CLOSE_ALL,function(){return en}),Object(d.a)(ze,Tt.CLOSE_TOP,function(t){return t.slice(0,-1)}),ze)),an=j({},!0,(Ze={},Object(d.a)(Ze,K.GOT_SETTINGS,function(t,e){return e.settings}),Object(d.a)(Ze,K.SET_SETTING,function(t,e){return Object.assign({},t,Object(d.a)({},e.key,e.value))}),Ze)),sn=Object(H.combineReducers)({auth:Ve,childrenLoaded:Xe,messages:tn,modals:nn,routing:G.d,settings:an,tasks:Qe("Task"),tags:Qe("Tag"),tag_groups:Qe("TagGroup")});function rn(t){var e=function(e){function n(){return Object(o.a)(this,n),Object(u.a)(this,Object(l.a)(n).apply(this,arguments))}return Object(p.a)(n,e),Object(c.a)(n,[{key:"componentDidMount",value:function(){this.checkAuth(this.props.isAuthenticated)}},{key:"componentDidUpdate",value:function(){this.checkAuth(this.props.isAuthenticated)}},{key:"checkAuth",value:function(t){if(!t){var e=this.props.location.pathname;this.props.dispatch(Object(G.b)("/home?next=".concat(e)))}}},{key:"render",value:function(){return!0===this.props.isAuthenticated?i.a.createElement(t,this.props):null}}]),n}(i.a.Component);return Object(b.b)(function(t){return{isAuthenticated:t.auth.backend.isAuthenticated()}})(e)}var on=n(202),cn=function(t){function e(t){var n;Object(o.a)(this,e),(n=Object(u.a)(this,Object(l.a)(e).call(this,t))).history=Fe()(),n.store=Object(H.createStore)(sn,Object(q.composeWithDevTools)(Object(H.applyMiddleware)(on.a,Object(G.c)(n.history))));var a=localStorage.getItem("token");if(null!==a){var i=JSON.parse(a);if(Be.a.decode(i.key,{complete:!0}).payload.exp>Date.now()/1e3)try{n.store.dispatch(P.loginSuccess(i))}catch(s){localStorage.clear("token")}else localStorage.clear("token"),n.store.dispatch(R.addMessage("info","MESSAGE_TOKEN_EXPIRED"))}return n}return Object(p.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return i.a.createElement(b.a,{store:this.store},i.a.createElement(G.a,{history:this.history},i.a.createElement(He,null,i.a.createElement(U.b,{exact:!0,path:"/",component:rn(de)}),i.a.createElement(U.b,{exact:!0,path:"/parent/:parentID",component:rn(de)}),i.a.createElement(U.b,{exact:!0,path:"/home",component:Ee}))))}}]),e}(i.a.Component);r.a.render(i.a.createElement(cn,null),document.getElementById("root"))}},[[207,2,1]]]);
//# sourceMappingURL=main.bd8617b4.chunk.js.map